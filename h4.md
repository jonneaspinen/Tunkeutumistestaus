# Sequel fish

### Osa 1 | Lue ja tiivistä
- Cialdinin suostuttelun periaatteet:  
  - Dr. Robert Cialdinin kehittämiä toimintaperiaatteita vaikuttamisseen ja vakuuttamiseen. Näitä voidaan hyöydyntää tuotteen tai asian myymisessä tai käyttää vaikutuskeinoina muissa tilanteissa.
  - **Reciprocity / vastavuoroisuus**: Kun tekee toiselle jotakin hyvää tai on ylipäätään ystävällinen, niin se ajaa toista tekemään samoin. Esimerkiksi annetaan asiakkaalle ilmainen näyte, jonka jälkeen he todennäköisemmin ostavat jotain.
  - **Commitment and consistency / sitoutuminen ja johdonmukaisuus**: Tavat ja tottumukset ajavat ihmisten toimintaa, mutta niitä ei voi luoda suoraan. Tätä periaatetta voidaan kuinkin käyttää siten, että toteutetaan pieniä helposti tehtäviä askeleita, joita pitkin voidaan joku saada sitoutumaan.
  - **Social proof / sosiaalinen todiste**: Kun tuotteella/asialla on hyvä kuva sosiaalisessa mediassa ja muiden ihmisten keskuudessa, se on hyväksi sen suosiolle. Esimerkiksi käytetään julkkiksia mainostamaan tuotteita. Ihmiset ostaa todennäköisemmin tuotteen/asian jota merkittävä henkilö suosittelee.
  - **Authority / auktoriteetti**: Vähän sama kuin edellisessä. Mitä korkeammalta taholta suositus tulee, sitä parempana ihmiset näkevät asian.
  - **Liking / tykkääminen**: Kun asiakkaat pitävät yrityksestä, heillä on myös luottoa siihen. Tähän voidaan vaikuttaa pitämällä hyvät välit asiakkaisiin ja sitä kautta voidaan vakuuttaa asiakas helpommin.
  - **Scarcity / niukkuus**: Kertomalla, että kyseinen tilanne tai tuote on ainut laatuaan tai niukasti saatavilla, voidaan luoda kohdehenkilölle tunne, että he eivät voi jättää käyttämättä tilaisuutta hyväksi.

  <sub>Lähde: [Indeed - Cialdini's 6 Principles](https://www.indeed.com/career-advice/career-development/cialdini-principles)</sub>
<br></br>

- SQL injection UNION attacks:
  - SQL-komentoon voidaan lisätä monia SELECT-kyselyitä.
  - Tämä tapahtuu käyttäen ```UNION```.
  Esim: ```SELECT a, b FROM table1 UNION SELECT c, d FROM table2```
  - Murtautumisessa on hydödyllistä myös selvittää taulukon sarakkeiden määrä, sen voi tehdä kahdella eri tavalla:
    
    Tekee ```ORDER BY``` kyselyjä lisäten aina rivin, kunnes tulee virheilmoitus.
    ```
    ' ORDER BY 1--        
    ' ORDER BY 2--      
    ' ORDER BY 3--
    ```
    Toinen vaihtoehto on tehdä ```UNION SELECT``` kyselyjä ja lisät haettavaksi eri määriä NULL-arvoja, kunnes tulee virheilmoitus.
    ```
    ' UNION SELECT NULL--
    ' UNION SELECT NULL,NULL--
    ' UNION SELECT NULL,NULL,NULL--
    ```
  - Kun sarakkeiden määrä on tiedossa voidaan selvittää myös, että minkälaista tietoa missäkin sarakkeessa on. Jos halutaan esimerkiksi löytää string muodossa olevaa dataa 3 sarakkeisesta taulukosta, voidaan käyttää seuraavaa kyselyä:
    ```
    ' UNION SELECT 'a',NULL,NULL,NULL--
    ' UNION SELECT NULL,'a',NULL,NULL--
    ' UNION SELECT NULL,NULL,'a',NULL--
    ```
  <sub>Lähde: [PortSwigger artikkeli - UNION attacks](https://portswigger.net/web-security/sql-injection/union-attacks)</sub>
  
- SQL injection cheat sheet:
  - Tästä oli tarkoituksena poimia jotakin itselleen hyödyllistä muistiin.
  - Tietokannan version selvitys:
    ```
    Oracle:       SELECT banner FROM v$version
                  SELECT version FROM v$instance
                  
    Microsoft:    SELECT @@version
    
    PostgreSQL:   SELECT version()
    
    MySQL: 	      SELECT @@version
    ```
  - Tietokannan taulujen ja sarakkeiden selvitys:
    ```
    Oracle:       SELECT * FROM all_tables
                  SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'
                  
    Microsoft:    SELECT * FROM information_schema.tables
                  SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
                  
    PostgreSQL:   SELECT * FROM information_schema.tables
                  SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
                  
    MySQL:        SELECT * FROM information_schema.tables
                  SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
    ```
  <sub>Lähde: [PortSwigger artikkeli - SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)</sub>

### Osa 2 | Murtautumisharjoittelua

#### a)  Kalassa. Laadi keihäskalasteluviesti (spear phising) kuvitteelliselle yritykselle.
Tavoitteena on saada kohde avaamaan liitteenä oleva Excel-dokumentti ja laittamaan makrot päälle. Käytä ainakin kahta Cialdinin periaatetta. Selitä, miten näitä periaatteita on sovellettu viestiisi. Keksi skennario ja kohde itse. Käytä työssä vain kuvitteellisia yrityksiä ja henkilöitä. Viestiä ei lähetetä mihinkään, se tulee vain raporttiin.

Tilanne:
Tekeydytään toisen yrityksen työntekijäksi ja tarjotaan yhteyistyömahdollisuutta, josta kohdeyritys hyötyy ilmaiseksi.
- Käytetään hyväksi toisen yrityksen mainetta ja hyvää asemaa. Tässä vaiheessa sillä ei ole väliä että minkäänlaista yhteyttä yhteyttä yritykseen ei oikeasti ole, sillä viestissä tuodaan esille, että kyseessä ei ole julkinen projekti.
- Tarjotaan palvelua ilmaiseksi, mutta ei kuitenkaan täysin ilmaiseksi (kysytään työpanosta), jotta erotutaan mainosten joukosta.
- Tuodaan esille, että kyseessä on ainutlaatuinen tilaisuus johon pitäisi reagoida nopeasti.
- Excel tiedosto asetetaan joko liitteeksi ja pyydetään viestinsaajaa avaamaan se
  - TAI lisätään johonkin mielenkiintoiseen kohtaan linkki, joka lataa tiedoston. Esimerkiksi "example of our work", joka lataa <Analytics demo>.

```
     To: WeDoElectricsStuff
Subject: Business collabration inquiry
   From: collaborationproject@<email>.com

         Hello,
         
         We are <known company>, a business to business company focused on creating a new
         and improved ways of analyzing statistics. At <known company>, we have some of the
         most experienced data analysts and researchers working with us in order to create
         a better future. We have just launched a new project with a goal of creating comprehensive
         data packs for businesses.
         
         We are looking for collaborations with other companies and thought that your company
         would fit the criteria. The goal of the collaboration would be to do a test run before
         we announce this to the public.
         
         This collaboration project is completely funded by us and our sponsors. For you, the
         output would be valuable information, free of charge, only requiring someone in your
         company to be in contact and work with us throughout the project.
         
         Please answer as soon as possible, as this is a limited change. We are only collaborating
         with a handful of companies. Also, please see the attached datasheet for details of the offer.
         
         Sincerely,
         James Jameston from <known company>
```

#### b) Portswigger labs
1) SQL injection vulnerability allowing login bypass.

2) SQL injection UNION attack, determining the number of columns returned by the query.

3) SQL injection UNION attack, finding a column containing text.

4) SQL injection UNION attack, retrieving data from other tables.

5) SQL injection UNION attack, retrieving multiple values in a single column.

6) SQL injection attack, querying the database type and version on Oracle.
